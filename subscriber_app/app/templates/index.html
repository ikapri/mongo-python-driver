<html ng-app="subscribe">
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.11/angular.min.js"></script>
    <script>
        var myApp = angular.module('subscribe', []);
        myApp.controller('SubscribtionController', ['$scope','websocketService',function($scope, websocketService){
            $scope.messages = [];
            websocketService.start("ws://localhost:8000/sub", function (evt) {
                console.log(evt);
                $scope.$apply(function () {
                    $scope.messages.unshift(evt.data);
                });
    });

        }]);
        myApp.factory('websocketService', function () {
        return {
            start: function (url, callback) {
                var websocket = new WebSocket(url);
                websocket.onopen = function () {
                };
                websocket.onclose = function () {
                };
                websocket.onmessage = function (evt) {
                    callback(evt);
                };
            }
        }
    }
);

    </script>
</head>
<body>
    <div ng-controller="SubscribtionController">
    {{msg}}
    <div ng-repeat="msg in messages track by $index">
        {{msg}}
    </div>
</div>
</body>
</html>